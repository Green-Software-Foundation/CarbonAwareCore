<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-samples/azure/azure-function/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Use Carbon Aware SDK with an Azure Function | Carbon Aware SDK</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://green-software-foundation.github.io/carbon-aware-sdk/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://green-software-foundation.github.io/carbon-aware-sdk/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://green-software-foundation.github.io/carbon-aware-sdk/docs/samples/azure/azure-function"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Use Carbon Aware SDK with an Azure Function | Carbon Aware SDK"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/carbon-aware-sdk/img/favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://green-software-foundation.github.io/carbon-aware-sdk/docs/samples/azure/azure-function"><link data-rh="true" rel="alternate" href="https://green-software-foundation.github.io/carbon-aware-sdk/docs/samples/azure/azure-function" hreflang="en"><link data-rh="true" rel="alternate" href="https://green-software-foundation.github.io/carbon-aware-sdk/docs/samples/azure/azure-function" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/carbon-aware-sdk/blog/rss.xml" title="Carbon Aware SDK RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/carbon-aware-sdk/blog/atom.xml" title="Carbon Aware SDK Atom Feed"><link rel="stylesheet" href="/carbon-aware-sdk/assets/css/styles.498ea13a.css">
<link rel="preload" href="/carbon-aware-sdk/assets/js/runtime~main.b00b7309.js" as="script">
<link rel="preload" href="/carbon-aware-sdk/assets/js/main.6448bd7a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#EBF2D7;color:#00524f" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><strong>‚ö† Incubation Project This project is an incubation project being run inside the Green Software Foundation; as such, we <b>DON'T</b> recommend using it in any critical use case. Incubation projects are experimental, offer no support guarantee, have minimal governance and process, and may be retired at any moment. This project may one day graduate, in which case this disclaimer will be removed. <br><br> üéâÔ∏è We are running a Hackathon! CarbonHack is open to all, including software practitioners and those with a passion for Green Software. Find out more on the <a href="https://grnsft.org/hack/github">CarbonHack website</a> </strong></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/carbon-aware-sdk/"><div class="navbar__logo"><img src="/carbon-aware-sdk/img/GSF-logo.jpg" alt="Carbon Aware SDK Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/carbon-aware-sdk/img/GSF-logo.jpg" alt="Carbon Aware SDK Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Carbon Aware SDK</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/carbon-aware-sdk/docs/quickstart">Tutorial</a><a class="navbar__item navbar__link" href="/carbon-aware-sdk/blog">Blog</a><a href="https://greensoftware.foundation/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GSF</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Green-Software-Foundation/carbon-aware-sdk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-aware-sdk/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/carbon-aware-sdk/docs/quickstart">Setting up and using the Carbon Aware SDK</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carbon-aware-sdk/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carbon-aware-sdk/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/carbon-aware-sdk/docs/category/architecture">Architecture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Architecture&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/carbon-aware-sdk/docs/category/samples">Samples</a><button aria-label="Toggle the collapsible sidebar category &#x27;Samples&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/carbon-aware-sdk/docs/samples/azure/apim-policy">azure</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-aware-sdk/docs/samples/azure/apim-policy">README</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/carbon-aware-sdk/docs/samples/azure/azure-function">Use Carbon Aware SDK with an Azure Function</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/carbon-aware-sdk/docs/samples/java-client">Java Client Example</a><button aria-label="Toggle the collapsible sidebar category &#x27;Java Client Example&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/carbon-aware-sdk/docs/samples/lib-integration/ConsoleApp">lib-integration</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-aware-sdk/docs/samples/python-proxy-server">Python proxy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/carbon-aware-sdk/docs/samples/watttime-registration">WattTime account creation</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/carbon-aware-sdk/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/carbon-aware-sdk/docs/category/samples"><span itemprop="name">Samples</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">azure</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Use Carbon Aware SDK with an Azure Function</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Use Carbon Aware SDK with an Azure Function</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">‚Äã</a></h2><p>The sample included showcase the Azure Functions tooling for the Carbon Aware
SDK <a href="/carbon-aware-sdk/docs/docs/architecture/c-sharp-client-library.md">C# Class Library</a>. It
includes an implementation for <code>GetAverageCarbonIntensity</code> and for
<code>GetCurrentForecast</code>. <code>GetAverageCarbonIntensity</code> uses the <code>EmissionsHandler</code> to
return the carbon intensity rate of a location for a specific timespan.
<code>GetCurrentForecast</code> uses the <code>ForecastHandler</code> to yield the optimal time of a
specified location and duration.</p><p>The functions can run locally for debugging or be deployed to Azure. See the
<a href="/carbon-aware-sdk/docs/docs/configuration.md#datasources">data source configuration docs</a> for
detailed information about configuring the data source(s) your Azure Function
will use.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-function-dependency-injection">Azure Function Dependency Injection<a href="#azure-function-dependency-injection" class="hash-link" aria-label="Direct link to Azure Function Dependency Injection" title="Direct link to Azure Function Dependency Injection">‚Äã</a></h2><p>The Carbon Aware SDK is included in the function .csproj file by
<a href="/carbon-aware-sdk/docs/docs/packaging.md#included-scripts">creating and adding the SDK as a package</a>.
The <a target="_blank" href="/carbon-aware-sdk/assets/files/Startup-7c4342c8bcb18dcbbc7425fe80d0b397.cs">Startup.cs</a> file uses dependency injection to access the
handlers in the library. The following code initializes the C# Library:</p><div class="language-C# codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-C# codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> public override void Configure(IFunctionsHostBuilder builder)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var configuration = builder.GetContext().Configuration;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            builder.Services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .AddEmissionsServices(configuration)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .AddForecastServices(configuration);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Note as the in-process
<a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-dotnet-dependency-injection" target="_blank" rel="noopener noreferrer">Azure Function uses dependency injection</a>
though via
<a href="https://www.nuget.org/packages/Microsoft.Azure.Functions.Extensions/" target="_blank" rel="noopener noreferrer">Microsoft.Azure.Functions.Extensions</a>
there is a version conflict of
<a href="https://www.nuget.org/packages/Microsoft.Extensions.Configuration" target="_blank" rel="noopener noreferrer">Microsoft.Extensions.Configuration</a>.
It is fixed adding a version specific project dependency (in .csproj) to the
same version as the Carbon Aware SDK. Microsoft.Extensions.Configuration is
backwards compatible.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="run-function-locally">Run Function Locally<a href="#run-function-locally" class="hash-link" aria-label="Direct link to Run Function Locally" title="Direct link to Run Function Locally">‚Äã</a></h2><p>Both Azure Function apps can be
<a href="https://learn.microsoft.com/azure/azure-functions/functions-develop-local" target="_blank" rel="noopener noreferrer">run locally</a>
without needing an Azure subscription. The process for running both is the same,
as they use the same configuration, just call different paths within the SDK.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites-to-run">Prerequisites to Run<a href="#prerequisites-to-run" class="hash-link" aria-label="Direct link to Prerequisites to Run" title="Direct link to Prerequisites to Run">‚Äã</a></h3><p><a href="https://dotnet.microsoft.com/download" target="_blank" rel="noopener noreferrer">.NET Core SDK</a></p><p><a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="start-function">Start Function<a href="#start-function" class="hash-link" aria-label="Direct link to Start Function" title="Direct link to Start Function">‚Äã</a></h3><p>To run and debug locally, update the <a target="_blank" href="/carbon-aware-sdk/assets/files/appsettings-c5546b12aae431bf752aa097c9902bf3.json">appsettings.json</a> file
to include the desired <a href="/carbon-aware-sdk/docs/docs/configuration.md">configuration</a>.</p><p>In the app folder (<code>samples/azure/azure-function</code>), run the command: <code>func start</code></p><p>After the function has compiled and is running, the URLs to the functions will
be presented.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-call-for-get-average-carbon-intensity-function"><em>Example call for Get Average Carbon Intensity function</em><a href="#example-call-for-get-average-carbon-intensity-function" class="hash-link" aria-label="Direct link to example-call-for-get-average-carbon-intensity-function" title="Direct link to example-call-for-get-average-carbon-intensity-function">‚Äã</a></h4><p>The following example will retrieve the Average Carbon Intensity. For this
example, query parameters were used, but the values could also be sent in the
body of the request.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --location --request GET </span><span class="token string" style="color:#e3116c">&#x27;http://localhost:7071/api/GetAverageCarbonIntensity?startDate=2022-03-01T15:30:00Z&amp;endDate=2022-03-01T18:30:00Z&amp;location=eastus&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-call-for-get-current-forecast-function"><em>Example call for Get Current Forecast function</em><a href="#example-call-for-get-current-forecast-function" class="hash-link" aria-label="Direct link to example-call-for-get-current-forecast-function" title="Direct link to example-call-for-get-current-forecast-function">‚Äã</a></h4><p>The following example will call the Current Forecast route. The request can use
either the request body or query parameters.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> --location --request GET </span><span class="token string" style="color:#e3116c">&#x27;http://localhost:7071/api/GetCurrentForecast&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header </span><span class="token string" style="color:#e3116c">&#x27;Content-Type: application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-raw </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;startDate&quot;: &quot;2022-11-02T15:30:00Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;endDate&quot;: &quot;2022-11-02T18:30:00Z&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;location&quot; : &quot;eastus&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    &quot;duration&quot;: 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Note: startDate and endDate must be a valid interval within the future 24
hours from the time of calling.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-to-azure">Deploy to Azure<a href="#deploy-to-azure" class="hash-link" aria-label="Direct link to Deploy to Azure" title="Direct link to Deploy to Azure">‚Äã</a></h2><p>If you have an Azure subscription, you can also deploy these functions to Azure.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites-to-deploy">Prerequisites to Deploy<a href="#prerequisites-to-deploy" class="hash-link" aria-label="Direct link to Prerequisites to Deploy" title="Direct link to Prerequisites to Deploy">‚Äã</a></h3><p>You must have the
<a href="https://learn.microsoft.com/en-us/cli/azure/install-azure-cli" target="_blank" rel="noopener noreferrer">Azure CLI</a> or
<a href="https://learn.microsoft.com/en-us/powershell/azure/install-az-ps" target="_blank" rel="noopener noreferrer">Azure PowerShell</a>
installed locally to be able to publish to Azure.</p><p><a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local" target="_blank" rel="noopener noreferrer">Azure Functions Core Tools</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-function-app">Create Function App<a href="#create-function-app" class="hash-link" aria-label="Direct link to Create Function App" title="Direct link to Create Function App">‚Äã</a></h3><p>Log in to Azure: <code>az login</code></p><p>Once the correct subscription is selected run the following script to create a
new function app:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Function app and storage account names must be unique.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Variable block</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">let</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;randomIdentifier=</span><span class="token string environment constant" style="color:#36acaa">$RANDOM</span><span class="token string" style="color:#e3116c">*</span><span class="token string environment constant" style="color:#36acaa">$RANDOM</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">location</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;eastus&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">resourceGroup</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;carbon-aware-</span><span class="token string variable" style="color:#36acaa">$randomIdentifier</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">storage</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;casaccount</span><span class="token string variable" style="color:#36acaa">$randomIdentifier</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">functionApp</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;carbon-aware-functionapp-</span><span class="token string variable" style="color:#36acaa">$randomIdentifier</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">skuStorage</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Standard_LRS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">functionsVersion</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create a resource group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Creating </span><span class="token string variable" style="color:#36acaa">$resourceGroup</span><span class="token string" style="color:#e3116c"> in &quot;</span><span class="token variable" style="color:#36acaa">$location</span><span class="token string" style="color:#e3116c">&quot;...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az group create --name </span><span class="token variable" style="color:#36acaa">$resourceGroup</span><span class="token plain"> --location </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$location</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create an Azure storage account in the resource group.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Creating </span><span class="token string variable" style="color:#36acaa">$storage</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az storage account create --name </span><span class="token variable" style="color:#36acaa">$storage</span><span class="token plain"> --location </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$location</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> --resource-group </span><span class="token variable" style="color:#36acaa">$resourceGroup</span><span class="token plain"> --sku </span><span class="token variable" style="color:#36acaa">$skuStorage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Create a serverless function app in the resource group.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Creating </span><span class="token string variable" style="color:#36acaa">$functionApp</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">az functionapp create --name </span><span class="token variable" style="color:#36acaa">$functionApp</span><span class="token plain"> --storage-account </span><span class="token variable" style="color:#36acaa">$storage</span><span class="token plain"> --consumption-plan-location </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$location</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> --resource-group </span><span class="token variable" style="color:#36acaa">$resourceGroup</span><span class="token plain"> --functions-version </span><span class="token variable" style="color:#36acaa">$functionsVersion</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="publish-functions">Publish Functions<a href="#publish-functions" class="hash-link" aria-label="Direct link to Publish Functions" title="Direct link to Publish Functions">‚Äã</a></h3><p>Update the <a target="_blank" href="/carbon-aware-sdk/assets/files/appsettings-c5546b12aae431bf752aa097c9902bf3.json">appsettings.json</a> file to include the desired
<a href="/carbon-aware-sdk/docs/docs/configuration.md">configuration</a>.</p><p>To publish the function code to a function app in Azure, use the publish command
in the samples/azure/azure-function folder:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">func azure functionapp publish </span><span class="token variable" style="color:#36acaa">$functionApp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">‚Äã</a></h2><p><a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference?tabs=blob" target="_blank" rel="noopener noreferrer">Azure Functions developer guide</a></p><p><a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-dotnet-dependency-injection" target="_blank" rel="noopener noreferrer">Use dependency injection in .NET Azure Functions</a></p><p><a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-run-local?tabs=v4%2Cwindows%2Ccsharp%2Cportal%2Cbash#start" target="_blank" rel="noopener noreferrer">Run functions locally</a></p><p><a href="https://learn.microsoft.com/en-us/azure/azure-functions/scripts/functions-cli-create-serverless?source=recommendations" target="_blank" rel="noopener noreferrer">Create a function app for serverless code execution</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Green-Software-Foundation/carbon-aware-sdk/docs/samples/azure/azure-function/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/carbon-aware-sdk/docs/samples/azure/apim-policy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">README</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/carbon-aware-sdk/docs/samples/java-client"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Java Client Example</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#azure-function-dependency-injection" class="table-of-contents__link toc-highlight">Azure Function Dependency Injection</a></li><li><a href="#run-function-locally" class="table-of-contents__link toc-highlight">Run Function Locally</a><ul><li><a href="#prerequisites-to-run" class="table-of-contents__link toc-highlight">Prerequisites to Run</a></li><li><a href="#start-function" class="table-of-contents__link toc-highlight">Start Function</a></li></ul></li><li><a href="#deploy-to-azure" class="table-of-contents__link toc-highlight">Deploy to Azure</a><ul><li><a href="#prerequisites-to-deploy" class="table-of-contents__link toc-highlight">Prerequisites to Deploy</a></li><li><a href="#create-function-app" class="table-of-contents__link toc-highlight">Create Function App</a></li><li><a href="#publish-functions" class="table-of-contents__link toc-highlight">Publish Functions</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/carbon-aware-sdk/docs/overview">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/green-software-foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/gsfcommunity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://greensoftwarefdn.slack.com/archives/C02JRAV4QEP" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack (private members only)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://greensoftware.foundation/" target="_blank" rel="noopener noreferrer" class="footer__link-item">greensoftware.foundation</a></li><li class="footer__item"><a href="https://github.com/Green-Software-Foundation/carbon-aware-sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2024 GSF, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/carbon-aware-sdk/assets/js/runtime~main.b00b7309.js"></script>
<script src="/carbon-aware-sdk/assets/js/main.6448bd7a.js"></script>
</body>
</html>